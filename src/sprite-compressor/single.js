var string = `.page-8 .disc .man {
	position: absolute;
	bottom: 18px;
	right: 38px;
	width: 50px;
	height: 90px;
	background-image: url("http://s3.music.126.net/nact/s/client/images/year2017/p07/man_repeat.png?38dd7495e388ff3ddad4f7e401e4b632");
	background-size: cover;
	-webkit-transform-origin: left top 0;
	-ms-transform-origin: left top 0;
	transform-origin: left top 0;
	-webkit-animation: man-disc 1s steps(1, end) infinite;
	animation: man-disc 1.42s steps(1, end) infinite;
	-webkit-transform: scale(0.5);
	-ms-transform: scale(0.5);
	transform: scale(0.5);
}

@-webkit-keyframes man-disc {
	0% {
		background-position: 0px 0px;
	}

	2.94% {
		background-position: -50px 0px;
	}

	5.88% {
		background-position: -100px 0px;
	}

	8.82% {
		background-position: -150px 0px;
	}

	11.76% {
		background-position: -200px 0px;
	}

	14.71% {
		background-position: -250px 0px;
	}

	17.65% {
		background-position: -300px 0px;
	}

	20.59% {
		background-position: -350px 0px;
	}

	23.53% {
		background-position: -400px 0px;
	}

	26.47% {
		background-position: -450px 0px;
	}

	29.41% {
		background-position: -500px 0px;
	}

	32.35% {
		background-position: -550px 0px;
	}

	35.29% {
		background-position: -600px 0px;
	}

	38.24% {
		background-position: -650px 0px;
	}

	41.18% {
		background-position: -700px 0px;
	}

	44.12% {
		background-position: -750px 0px;
	}

	47.06% {
		background-position: -800px 0px;
	}

	50% {
		background-position: -850px 0px;
	}

	52.94% {
		background-position: -900px 0px;
	}

	55.88% {
		background-position: -950px 0px;
	}

	58.82% {
		background-position: -1000px 0px;
	}

	61.76% {
		background-position: -1050px 0px;
	}

	64.71% {
		background-position: -1100px 0px;
	}

	67.65% {
		background-position: -1150px 0px;
	}

	70.59% {
		background-position: -1200px 0px;
	}

	73.53% {
		background-position: -1250px 0px;
	}

	76.47% {
		background-position: -1300px 0px;
	}

	79.41% {
		background-position: -1350px 0px;
	}

	82.35% {
		background-position: -1400px 0px;
	}

	85.29% {
		background-position: -1450px 0px;
	}

	88.24% {
		background-position: -1500px 0px;
	}

	91.18% {
		background-position: -1550px 0px;
	}

	94.12% {
		background-position: -1600px 0px;
	}

	97.06% {
		background-position: -1650px 0px;
	}

	100% {
		background-position: -1700px 0px;
	}
}

@keyframes man-disc {

	0% {
		background-position: 0px 0px;
	}

	2.94% {
		background-position: -50px 0px;
	}

	5.88% {
		background-position: -100px 0px;
	}

	8.82% {
		background-position: -150px 0px;
	}

	11.76% {
		background-position: -200px 0px;
	}

	14.71% {
		background-position: -250px 0px;
	}

	17.65% {
		background-position: -300px 0px;
	}

	20.59% {
		background-position: -350px 0px;
	}

	23.53% {
		background-position: -400px 0px;
	}

	26.47% {
		background-position: -450px 0px;
	}

	29.41% {
		background-position: -500px 0px;
	}

	32.35% {
		background-position: -550px 0px;
	}

	35.29% {
		background-position: -600px 0px;
	}

	38.24% {
		background-position: -650px 0px;
	}

	41.18% {
		background-position: -700px 0px;
	}

	44.12% {
		background-position: -750px 0px;
	}

	47.06% {
		background-position: -800px 0px;
	}

	50% {
		background-position: -850px 0px;
	}

	52.94% {
		background-position: -900px 0px;
	}

	55.88% {
		background-position: -950px 0px;
	}

	58.82% {
		background-position: -1000px 0px;
	}

	61.76% {
		background-position: -1050px 0px;
	}

	64.71% {
		background-position: -1100px 0px;
	}

	67.65% {
		background-position: -1150px 0px;
	}

	70.59% {
		background-position: -1200px 0px;
	}

	73.53% {
		background-position: -1250px 0px;
	}

	76.47% {
		background-position: -1300px 0px;
	}

	79.41% {
		background-position: -1350px 0px;
	}

	82.35% {
		background-position: -1400px 0px;
	}

	85.29% {
		background-position: -1450px 0px;
	}

	88.24% {
		background-position: -1500px 0px;
	}

	91.18% {
		background-position: -1550px 0px;
	}

	94.12% {
		background-position: -1600px 0px;
	}

	97.06% {
		background-position: -1650px 0px;
	}

	100% {
		background-position: -1700px 0px;
	}
}
`
// var reg = /animation: ([\w-]+)\s/g
// console.log(string.match(res))
// console.log(1)
// var demo = []
// for (let i = 0; i < string.length; i++)
// {
// 	demo.push(string[i])
// }
// var stack = []
// for (let i = 0; i < demo.length; i++)
// {
// 	if (demo[i] == 'k' && demo[i + 1] == 'e' && demo[i + 2] == 'y' && demo[i + 3] == 'f' && demo[i + 4] == 'r' && demo[
// 			i + 5] == 'a' && demo[i + 6] == 'm' && demo[i + 7] == 'e')
// 	{
// 		while (demo[i] !== '{')
// 		{
// 			i++
// 		}
// 		var start = i
// 		console.log(start)
// 		stack.push(demo[i])
// 		i++
// 		// console.log(stack)
// 		while (stack !== [] && i < demo.length)
// 		{
// 			// console.log(demo[i])
// 			if (demo[i] === '{')
// 			{
// 				stack.push(demo[i])
// 			}
// 			if (demo[i] === '}')
// 			{
// 				stack.pop()
// 			}
// 			i++
// 		}
// 		var end = i
// 		console.log(end)
// 	}
// }
// console.log(cccdemo.length)

var reg = /([\d.]*% {\n\t\tbackground-position: .*;\n\t)}/g
// 匹配每一帧的数据
var num = string.match(reg)

// console.log(num)
console.log(num.length / 2)
var num = num.length / 2 - 1
var yes = string.replace(reg, function (match, pos) {
    if ((match[0] == '0' && match[1] == '%') || (match[0] == '1' && match[1] == '0' && match[2] == '0' && match[
        3] == '%')) {
        return match
    } else {
        return ""
    }
})

var reg = /man-disc.*steps\((.*)\)/g
var yes = yes.replace(reg, function (match, pos) {
    var positon = match.indexOf('steps')
    var res = match.slice(0, positon) + "steps(" + (num) + ")"
    return (res)

})
// console.log(yes)
var reg = /background-position:(.*)px(.*)px/g
// var reg=/background-position/g
var res = yes.replace(reg, 'transform: translate3d( $1 px ,$2px ,0px);')
console.log(res)
// 'transform: translate3d( $1 px ,$2px ,0px);'
